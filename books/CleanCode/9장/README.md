# 9장. 단위 테스트

> 애자일 방법론, TDD, 단위 테스트 자동화 시스템 등 개발 분야에 많은 성장이 있었지만, 오히려 테스트를 추가하기 위해 제대로 된 테스트를 설계하지 못하고 있다...

## TDD

여기서 `TDD (Test Driven Development)`란, 테스트 주도 개발의 약어로 소프트워에 개발 방법론 중 하나입니다. 주로 다음 3가지 법칙을 기반으로 합니다.

1. 테스트 코드 작성: 우선 실패하는 테스트 코드를 작성합니다.
2. 코드 작성: 테스트를 통과할 수 있을 정도로 최소한의 코드를 작성합니다.
3. 테스트 실행: 테스트를 실행합니다.

## 테스트는 왜 필요한가?

실제 코드의 품질은 좋으나, 테스트 코드가 좋지 못한 경우에도 제품의 품질을 보장할 수 있는가에 대한 질문에 `Clean Code`에서는 `그렇지 않다`라고 대답합니다.

그러면서 테스트 코드에 대해 다음과 같이 평가합니다:
> 테스트는 유연성, 유지보수성, 재사용성을 제공한다.

- 코드에 버그가 있진 않을까?
    👉 테스트 코드를 잘 작성하여 버그에 대한 걱정을 줄일 수 있습니다.
- 이 코드를 고쳐도 제품이 원활하게 동작할까?
    👉 기존에 작성된 테스트 코드는 제품의 변화에 유연성을 제공합니다.
- 저번에 작성한 코드가 기억이 잘 안나네 문서를 확인해볼까?
    👉 테스트 케이스와 테스트 코드는 문서를 대체합니다.

## 테스트 코드 작성 규칙

> 실제 코드보다 테스트 코드의 가독성이 더 중요할 수도 있다. 최소한의 표현으로 많은 것을 나타내는 연습을 해보자.

### ✔️ 가독성

테스트 코드의 가독성이 실제 서비스를 구현하는 코드의 가독성이 중요하다는 사실을 가장 먼저 언급합니다.  
사실 이 부분은 E2E 테스트나 유닛테스트를 작성해보면 조금이라도 이해가 갈 수 있습니다.

가장 먼저 알려주는 방법은 하나의 테스트 케이스에 하나의 `assert`문을 사용하라는 것입니다.  

아래 간단한 예시와 같이 `addNumber` 메서드를 테스트 하는 케이스에는 그 함수의 결과값만 비교하는 assert만 존재하면 충분할 것 같습니다:
```javascript
describe('Maht Method', () => {
  test('[function] addNumber', async () => {
    const result = addNumber(1, 1)
    
    expect(result).toBe(2)
  })
})
```

### ✔️ F.I.R.S.T

- Fast: 테스트는 자주 돌릴 수 있게 `빠르게`` 실행되어야 합니다. 
- Independent: 각각의 테스트는 서로 `의존해서는 안됩니다`. 1개를 실행해도 10개를 실행해도 모두 통과해야 합니다.
- Repeatable: 어떠한 환경에서도 테스트는 실행할 수 있어야 합니다.
- Self-validating: 테스트 결과는 true (통과) / false (실패)로만 나뉘어야 합니다. 불필요한 결과를 assert문에서 비교하지 않아야 합니다.
- Timely: 테스트 코드를 적시에 작성해야 합니다. TDD 기반의 개발 방법론을 따른다면 실제 코드가 구현되기 이전에 유닛테스트를 작성하는 것을 가리킵니다. 코드가 먼저 구현되면 유닛테스트를 잊지 않아야 합니다.

### ✨ 결론

- 테스트 코드가 서비스를 구현하는 코드보다 중요하진 않지만 중요한 것은 이제 알겠다.
- 테스트 코드를 유지보수하는 일이 상당히 까다롭다. 작성할 때 `가독성` 잊지 말자.
- TDD는 어려워도 테스트 케이스를 먼저 구상하면 예외처리에 대한 코드 작성이 용이해지는 것은 개발하면서 많이 느꼈다. 잊지말자.